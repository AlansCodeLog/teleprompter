"use strict";

var _electron = require("electron");

var _fs = _interopRequireDefault(require("fs"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const {
  dialog
} = _electron.remote;

function calculate_counters(editor, counter_all, wpm, minutes) {
  return function handler(e) {
    let word_count = editor.value.split(/\s+/gm).length;
    counter_all.textContent = "".concat(word_count);
    let wpm_val = parseInt(wpm.value, 10);
    let read_time;

    if (wpm_val == undefined) {
      read_time = "Invalid Input";
    } else {
      read_time = "".concat(ms_to_time(Math.round(word_count / wpm_val * 60 * 1000)));
    }

    minutes.textContent = read_time;
  };
}

document.addEventListener('DOMContentLoaded', () => {
  let wrapper = document.querySelector(".wrapper");
  let editor = document.querySelector(".editor");
  let menu = document.querySelector(".menu");
  let topbar = document.querySelector(".topbar"); // let counter_part = document.querySelector(".counter-part")! as HTMLDivElement

  let counter_all = document.querySelector(".counter-all");
  let wpm = document.querySelector(".wpm");
  let minutes = document.querySelector(".minutes");
  let time = document.querySelector(".time");
  let time_val = document.querySelector(".time-val");
  let button_open = document.querySelector(".open");
  let button_save = document.querySelector(".save");
  let button_save_as = document.querySelector(".save-as");
  let opacity_more = document.querySelector(".opacity-more");
  let opacity_less = document.querySelector(".opacity-less");
  let transparent_background = document.querySelector(".transparent-background");
  menu.addEventListener("click", () => {
    let showing = topbar.style.display == "flex";

    if (showing) {
      topbar.style.display = "none";
      showing = false;
    } else {
      topbar.style.display = "flex";
      showing = true;
    }
  });

  const flex_handler = () => {
    let flexed = flex_detector(topbar, "row");

    if (flexed) {
      topbar.classList.add("wrapped");
    } else {
      topbar.classList.remove("wrapped");
    }
  };

  window.addEventListener("resize", flex_handler);
  flex_handler();
  let file;
  button_open.addEventListener("click", e => {
    dialog.showOpenDialog({
      properties: ['openFile']
    }, function (filename) {
      if (filename) {
        file = filename[0];

        _fs.default.readFile(file, (err, contents) => {
          editor.value = contents.toString();
        });
      }
    });
  });
  button_save.addEventListener("click", e => {
    _fs.default.writeFile(file, editor.value, err => {
      if (err) {
        console.log(err);
      }
    });
  });
  button_save_as.addEventListener("click", e => {
    dialog.showSaveDialog({
      defaultPath: file
    }, function (filename) {
      if (filename) {
        file = filename;

        _fs.default.writeFile(file, editor.value, err => {
          console.log(err);
        });
      }
    });
  });
  const handler = calculate_counters(editor, counter_all, wpm, minutes);
  editor.addEventListener("input", handler);
  let timer;
  let interval;
  time.addEventListener("click", () => {
    if (timer) {
      clearInterval(interval);
      time.textContent = "⏱️";
      timer = undefined;
    } else {
      time.textContent = "🛑";
      timer = new Date();
      time_val.textContent = "00:00:00";
      interval = setInterval(() => {
        let finish = new Date(); //@ts-ignore - Dates can be compared damn it.

        let elapsed = ms_to_time(finish - timer);
        time_val.textContent = "".concat(elapsed);
        console.log(elapsed);
      }, 100);
    }
  });

  const opacity_less_handler = () => {
    let el_opacity = getComputedStyle(wrapper).opacity;
    let opacity = el_opacity === null || el_opacity === "" ? 0 : parseFloat(el_opacity);
    wrapper.style.opacity = opacity - 0.1 >= 0 ? "".concat(opacity - 0.1) : "0";
  };

  opacity_less.addEventListener("click", opacity_less_handler);

  const opacity_more_handler = () => {
    let el_opacity = getComputedStyle(wrapper).opacity;
    let opacity = el_opacity === null || el_opacity === "" ? 0 : parseFloat(el_opacity);
    wrapper.style.opacity = opacity + 0.1 <= 1 ? "".concat(opacity + 0.1) : "1";
  };

  opacity_more.addEventListener("click", opacity_more_handler);
  let bg_state = 0.5;

  const bg_state_toggler = () => {
    if (bg_state == 0.5) {
      wrapper.style.background = "rgba(0,0,0,1)";
      bg_state = 1;
    } else {
      wrapper.style.background = "rgba(0,0,0,0.5)";
      bg_state = 0.5;
    }
  };

  transparent_background.addEventListener("click", bg_state_toggler);
  window.addEventListener("keydown", e => {
    if (e.ctrlKey && e.altKey) {
      if (e.key == "-") {
        opacity_less_handler();
      } else if (e.key == "+" || e.key == "=") {
        opacity_more_handler();
      }
    }

    if (e.ctrlKey && !e.altKey && !e.shiftKey && e.key == "Tab") {
      bg_state_toggler();
    }
  });
});

function ms_to_time(ms) {
  let seconds = Math.floor(ms / 1000 % 60).toString();
  let minutes = Math.floor(ms / (1000 * 60) % 60).toString();
  let hours = Math.floor(ms / (1000 * 60 * 60) % 24).toString();
  return "".concat(hours.padStart(2, "0"), ":").concat(minutes.padStart(2, "0"), ":").concat(seconds.padStart(2, "0"));
}

function flex_detector(element) {
  let row_or_column = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : "row";
  let dir = {
    pos: "y",
    w_or_h: "height"
  };

  if (row_or_column == "column") {
    dir = {
      pos: "x",
      w_or_h: "width"
    };
  }

  let el = element;
  let first = el.children[0].getBoundingClientRect();
  let last = el.children[el.children.length - 1].getBoundingClientRect(); // should work even if the flex items are different heights
  // only exceptions i think are if the element aligns itself below another element somehow

  if (first[dir.pos] + first[dir.w_or_h] < last[dir.pos]) {
    return true;
  } else {
    return false;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy10cy9yZW5kZXJlci50cyJdLCJuYW1lcyI6WyJkaWFsb2ciLCJyZW1vdGUiLCJjYWxjdWxhdGVfY291bnRlcnMiLCJlZGl0b3IiLCJjb3VudGVyX2FsbCIsIndwbSIsIm1pbnV0ZXMiLCJoYW5kbGVyIiwiZSIsIndvcmRfY291bnQiLCJ2YWx1ZSIsInNwbGl0IiwibGVuZ3RoIiwidGV4dENvbnRlbnQiLCJ3cG1fdmFsIiwicGFyc2VJbnQiLCJyZWFkX3RpbWUiLCJ1bmRlZmluZWQiLCJtc190b190aW1lIiwiTWF0aCIsInJvdW5kIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwid3JhcHBlciIsInF1ZXJ5U2VsZWN0b3IiLCJtZW51IiwidG9wYmFyIiwidGltZSIsInRpbWVfdmFsIiwiYnV0dG9uX29wZW4iLCJidXR0b25fc2F2ZSIsImJ1dHRvbl9zYXZlX2FzIiwib3BhY2l0eV9tb3JlIiwib3BhY2l0eV9sZXNzIiwidHJhbnNwYXJlbnRfYmFja2dyb3VuZCIsInNob3dpbmciLCJzdHlsZSIsImRpc3BsYXkiLCJmbGV4X2hhbmRsZXIiLCJmbGV4ZWQiLCJmbGV4X2RldGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwid2luZG93IiwiZmlsZSIsInNob3dPcGVuRGlhbG9nIiwicHJvcGVydGllcyIsImZpbGVuYW1lIiwiZnMiLCJyZWFkRmlsZSIsImVyciIsImNvbnRlbnRzIiwidG9TdHJpbmciLCJ3cml0ZUZpbGUiLCJjb25zb2xlIiwibG9nIiwic2hvd1NhdmVEaWFsb2ciLCJkZWZhdWx0UGF0aCIsInRpbWVyIiwiaW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwiRGF0ZSIsInNldEludGVydmFsIiwiZmluaXNoIiwiZWxhcHNlZCIsIm9wYWNpdHlfbGVzc19oYW5kbGVyIiwiZWxfb3BhY2l0eSIsImdldENvbXB1dGVkU3R5bGUiLCJvcGFjaXR5IiwicGFyc2VGbG9hdCIsIm9wYWNpdHlfbW9yZV9oYW5kbGVyIiwiYmdfc3RhdGUiLCJiZ19zdGF0ZV90b2dnbGVyIiwiYmFja2dyb3VuZCIsImN0cmxLZXkiLCJhbHRLZXkiLCJrZXkiLCJzaGlmdEtleSIsIm1zIiwic2Vjb25kcyIsImZsb29yIiwiaG91cnMiLCJwYWRTdGFydCIsImVsZW1lbnQiLCJyb3dfb3JfY29sdW1uIiwiZGlyIiwicG9zIiwid19vcl9oIiwiZWwiLCJmaXJzdCIsImNoaWxkcmVuIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGFzdCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFHQTs7OztBQUZBLE1BQU07QUFBRUEsRUFBQUE7QUFBRixJQUFhQyxnQkFBbkI7O0FBTUEsU0FBU0Msa0JBQVQsQ0FBNEJDLE1BQTVCLEVBQXlEQyxXQUF6RCxFQUFzRkMsR0FBdEYsRUFBNkdDLE9BQTdHLEVBQXNJO0FBQ3JJLFNBQU8sU0FBU0MsT0FBVCxDQUFpQkMsQ0FBakIsRUFBMkI7QUFDakMsUUFBSUMsVUFBVSxHQUFHTixNQUFNLENBQUNPLEtBQVAsQ0FBYUMsS0FBYixDQUFtQixPQUFuQixFQUE0QkMsTUFBN0M7QUFDQVIsSUFBQUEsV0FBVyxDQUFDUyxXQUFaLGFBQTZCSixVQUE3QjtBQUNBLFFBQUlLLE9BQU8sR0FBR0MsUUFBUSxDQUFDVixHQUFHLENBQUNLLEtBQUwsRUFBWSxFQUFaLENBQXRCO0FBQ0EsUUFBSU0sU0FBSjs7QUFDQSxRQUFJRixPQUFPLElBQUlHLFNBQWYsRUFBMEI7QUFDekJELE1BQUFBLFNBQVMsR0FBRyxlQUFaO0FBQ0EsS0FGRCxNQUVPO0FBRU5BLE1BQUFBLFNBQVMsYUFBTUUsVUFBVSxDQUFDQyxJQUFJLENBQUNDLEtBQUwsQ0FBWVgsVUFBVSxHQUFHSyxPQUFkLEdBQXlCLEVBQXpCLEdBQThCLElBQXpDLENBQUQsQ0FBaEIsQ0FBVDtBQUNBOztBQUNEUixJQUFBQSxPQUFPLENBQUNPLFdBQVIsR0FBc0JHLFNBQXRCO0FBQ0EsR0FaRDtBQWFBOztBQUVESyxRQUFRLENBQUNDLGdCQUFULENBQTBCLGtCQUExQixFQUE4QyxNQUFN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LEdBQUcsRUFBRSxHQUFQO0FBQVlDLElBQUFBLE1BQU0sRUFBRTtBQUFwQixHQUExRDs7QUFDQSxNQUFJSCxhQUFhLElBQUksUUFBckIsRUFBK0I7QUFDOUJDLElBQUFBLEdBQUcsR0FBRztBQUFFQyxNQUFBQSxHQUFHLEVBQUUsR0FBUDtBQUFZQyxNQUFBQSxNQUFNLEVBQUU7QUFBcEIsS0FBTjtBQUNBOztBQUVELE1BQUlDLEVBQUUsR0FBR0wsT0FBVDtBQUVBLE1BQUlNLEtBQUssR0FBR0QsRUFBRSxDQUFDRSxRQUFILENBQVksQ0FBWixFQUFlQyxxQkFBZixFQUFaO0FBQ0EsTUFBSUMsSUFBSSxHQUFHSixFQUFFLENBQUNFLFFBQUgsQ0FBWUYsRUFBRSxDQUFDRSxRQUFILENBQVkvRSxNQUFaLEdBQXFCLENBQWpDLEVBQW9DZ0YscUJBQXBDLEVBQVgsQ0FUcUYsQ0FVckY7QUFDQTs7QUFFQSxNQUFJRixLQUFLLENBQUNKLEdBQUcsQ0FBQ0MsR0FBTCxDQUFMLEdBQWlCRyxLQUFLLENBQUNKLEdBQUcsQ0FBQ0UsTUFBTCxDQUF0QixHQUFxQ0ssSUFBSSxDQUFDUCxHQUFHLENBQUNDLEdBQUwsQ0FBN0MsRUFBd0Q7QUFDdkQsV0FBTyxJQUFQO0FBQ0EsR0FGRCxNQUVPO0FBQ04sV0FBTyxLQUFQO0FBQ0E7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cmVtb3RlfSBmcm9tIFwiZWxlY3Ryb25cIlxuY29uc3QgeyBkaWFsb2cgfSA9IHJlbW90ZVxuXG5pbXBvcnQgZnMgZnJvbSBcImZzXCJcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCJcblxuXG5mdW5jdGlvbiBjYWxjdWxhdGVfY291bnRlcnMoZWRpdG9yOiBIVE1MVGV4dEFyZWFFbGVtZW50LCBjb3VudGVyX2FsbDogSFRNTERpdkVsZW1lbnQsIHdwbTogSFRNTElucHV0RWxlbWVudCwgbWludXRlczogSFRNTERpdkVsZW1lbnQpIHtcblx0cmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIoZTogRXZlbnQpIHtcblx0XHRsZXQgd29yZF9jb3VudCA9IGVkaXRvci52YWx1ZS5zcGxpdCgvXFxzKy9nbSkubGVuZ3RoXG5cdFx0Y291bnRlcl9hbGwudGV4dENvbnRlbnQgPSBgJHt3b3JkX2NvdW50fWBcblx0XHRsZXQgd3BtX3ZhbCA9IHBhcnNlSW50KHdwbS52YWx1ZSwgMTApXG5cdFx0bGV0IHJlYWRfdGltZVxuXHRcdGlmICh3cG1fdmFsID09IHVuZGVmaW5lZCkge1xuXHRcdFx0cmVhZF90aW1lID0gXCJJbnZhbGlkIElucHV0XCJcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRyZWFkX3RpbWUgPSBgJHttc190b190aW1lKE1hdGgucm91bmQoKHdvcmRfY291bnQgLyB3cG1fdmFsKSAqIDYwICogMTAwMCkpfWBcblx0XHR9XG5cdFx0bWludXRlcy50ZXh0Q29udGVudCA9IHJlYWRfdGltZVxuXHR9XG59XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG5cdGxldCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53cmFwcGVyXCIpISBhcyBIVE1MVGV4dEFyZWFFbGVtZW50XG5cdGxldCBlZGl0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXRvclwiKSEgYXMgSFRNTFRleHRBcmVhRWxlbWVudFxuXHRsZXQgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVudVwiKSEgYXMgSFRNTERpdkVsZW1lbnRcblx0bGV0IHRvcGJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9wYmFyXCIpISBhcyBIVE1MRGl2RWxlbWVudFxuXHQvLyBsZXQgY291bnRlcl9wYXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb3VudGVyLXBhcnRcIikhIGFzIEhUTUxEaXZFbGVtZW50XG5cdGxldCBjb3VudGVyX2FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY291bnRlci1hbGxcIikhIGFzIEhUTUxEaXZFbGVtZW50XG5cdGxldCB3cG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndwbVwiKSEgYXMgSFRNTElucHV0RWxlbWVudFxuXHRsZXQgbWludXRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWludXRlc1wiKSEgYXMgSFRNTERpdkVsZW1lbnRcblx0bGV0IHRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRpbWVcIikhIGFzIEhUTUxEaXZFbGVtZW50XG5cdGxldCB0aW1lX3ZhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGltZS12YWxcIikhIGFzIEhUTUxEaXZFbGVtZW50XG5cdGxldCBidXR0b25fb3BlbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3BlblwiKSEgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcblx0bGV0IGJ1dHRvbl9zYXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zYXZlXCIpISBhcyBIVE1MQnV0dG9uRWxlbWVudFxuXHRsZXQgYnV0dG9uX3NhdmVfYXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNhdmUtYXNcIikhIGFzIEhUTUxCdXR0b25FbGVtZW50XG5cdGxldCBvcGFjaXR5X21vcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm9wYWNpdHktbW9yZVwiKSEgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcblx0bGV0IG9wYWNpdHlfbGVzcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3BhY2l0eS1sZXNzXCIpISBhcyBIVE1MQnV0dG9uRWxlbWVudFxuXHRsZXQgdHJhbnNwYXJlbnRfYmFja2dyb3VuZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudHJhbnNwYXJlbnQtYmFja2dyb3VuZFwiKSEgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcblxuXHRtZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0bGV0IHNob3dpbmcgPSB0b3BiYXIuc3R5bGUuZGlzcGxheSA9PSBcImZsZXhcIlxuXHRcdGlmIChzaG93aW5nKSB7XG5cdFx0XHR0b3BiYXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXG5cdFx0XHRzaG93aW5nID0gZmFsc2Vcblx0XHR9IGVsc2Uge1xuXHRcdFx0dG9wYmFyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIlxuXHRcdFx0c2hvd2luZyA9IHRydWVcblx0XHR9XG5cdH0pXG5cblxuXHRjb25zdCBmbGV4X2hhbmRsZXIgPSAoKSA9PiB7XG5cdFx0bGV0IGZsZXhlZCA9IGZsZXhfZGV0ZWN0b3IodG9wYmFyLCBcInJvd1wiKVxuXG5cdFx0aWYgKGZsZXhlZCkge1xuXHRcdFx0dG9wYmFyLmNsYXNzTGlzdC5hZGQoXCJ3cmFwcGVkXCIpXG5cdFx0fSBlbHNlIHtcblx0XHRcdHRvcGJhci5jbGFzc0xpc3QucmVtb3ZlKFwid3JhcHBlZFwiKVxuXHRcdH1cblx0fVxuXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGZsZXhfaGFuZGxlcilcblxuXHRmbGV4X2hhbmRsZXIoKVxuXG5cblx0bGV0IGZpbGU6IHN0cmluZ1xuXG5cdGJ1dHRvbl9vcGVuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdGRpYWxvZy5zaG93T3BlbkRpYWxvZyh7IHByb3BlcnRpZXM6IFsgJ29wZW5GaWxlJyBdIH0sIGZ1bmN0aW9uIChmaWxlbmFtZSkge1xuXHRcdFx0aWYgKGZpbGVuYW1lKSB7XG5cdFx0XHRcdGZpbGUgPSBmaWxlbmFtZVswXVxuXG5cdFx0XHRcdGZzLnJlYWRGaWxlKGZpbGUsIChlcnIsIGNvbnRlbnRzKSA9PiB7XG5cdFx0XHRcdFx0ZWRpdG9yLnZhbHVlID0gY29udGVudHMudG9TdHJpbmcoKVxuXHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KVxuXG5cdGJ1dHRvbl9zYXZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdGZzLndyaXRlRmlsZShmaWxlLCBlZGl0b3IudmFsdWUsIChlcnIpID0+IHtcblx0XHRcdGlmIChlcnIpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKVxuXHRcdFx0fVxuXHRcdH0pXG5cdH0pXG5cblx0YnV0dG9uX3NhdmVfYXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG5cdFx0ZGlhbG9nLnNob3dTYXZlRGlhbG9nKHsgZGVmYXVsdFBhdGg6IGZpbGUgfSwgZnVuY3Rpb24gKGZpbGVuYW1lKSB7XG5cdFx0XHRpZiAoZmlsZW5hbWUpIHtcblx0XHRcdFx0ZmlsZSA9IGZpbGVuYW1lXG5cdFx0XHRcdGZzLndyaXRlRmlsZShmaWxlLCBlZGl0b3IudmFsdWUsIChlcnIpID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnIpXG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pXG5cblxuXHRjb25zdCBoYW5kbGVyID0gY2FsY3VsYXRlX2NvdW50ZXJzKGVkaXRvciwgY291bnRlcl9hbGwsIHdwbSwgbWludXRlcylcblxuXHRlZGl0b3IuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGhhbmRsZXIpXG5cblx0bGV0IHRpbWVyOiB1bmRlZmluZWQgfCBEYXRlXG5cblx0bGV0IGludGVydmFsOiBOb2RlSlMuVGltZW91dFxuXG5cdHRpbWUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblxuXHRcdGlmICh0aW1lcikge1xuXHRcdFx0Y2xlYXJJbnRlcnZhbChpbnRlcnZhbClcblx0XHRcdHRpbWUudGV4dENvbnRlbnQgPSBcIuKPse+4j1wiXG5cdFx0XHR0aW1lciA9IHVuZGVmaW5lZFxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aW1lLnRleHRDb250ZW50ID0gXCLwn5uRXCJcblx0XHRcdHRpbWVyID0gbmV3IERhdGUoKVxuXHRcdFx0dGltZV92YWwudGV4dENvbnRlbnQgPSBcIjAwOjAwOjAwXCJcblx0XHRcdGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuXHRcdFx0XHRsZXQgZmluaXNoID0gbmV3IERhdGUoKVxuXHRcdFx0XHQvL0B0cy1pZ25vcmUgLSBEYXRlcyBjYW4gYmUgY29tcGFyZWQgZGFtbiBpdC5cblx0XHRcdFx0bGV0IGVsYXBzZWQgPSBtc190b190aW1lKGZpbmlzaCAtIHRpbWVyKVxuXG5cdFx0XHRcdHRpbWVfdmFsLnRleHRDb250ZW50ID0gYCR7ZWxhcHNlZH1gXG5cdFx0XHRcdGNvbnNvbGUubG9nKGVsYXBzZWQpO1xuXG5cdFx0XHR9LCAxMDApXG5cdFx0fVxuXHR9KVxuXG5cblx0Y29uc3Qgb3BhY2l0eV9sZXNzX2hhbmRsZXIgPSAoKSA9PiB7XG5cdFx0bGV0IGVsX29wYWNpdHkgPSBnZXRDb21wdXRlZFN0eWxlKHdyYXBwZXIpLm9wYWNpdHlcblx0XHRsZXQgb3BhY2l0eSA9IGVsX29wYWNpdHkgPT09IG51bGwgfHwgZWxfb3BhY2l0eSA9PT0gXCJcIiA/IDAgOiBwYXJzZUZsb2F0KGVsX29wYWNpdHkpXG5cblx0XHR3cmFwcGVyLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5IC0gMC4xID49IDAgPyBgJHtvcGFjaXR5IC0gMC4xfWAgOiBgMGBcblx0fVxuXG5cdG9wYWNpdHlfbGVzcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BhY2l0eV9sZXNzX2hhbmRsZXIpXG5cblx0Y29uc3Qgb3BhY2l0eV9tb3JlX2hhbmRsZXIgPSAoKSA9PiB7XG5cdFx0bGV0IGVsX29wYWNpdHkgPSBnZXRDb21wdXRlZFN0eWxlKHdyYXBwZXIpLm9wYWNpdHlcblx0XHRsZXQgb3BhY2l0eSA9IGVsX29wYWNpdHkgPT09IG51bGwgfHwgZWxfb3BhY2l0eSA9PT0gXCJcIiA/IDAgOiBwYXJzZUZsb2F0KGVsX29wYWNpdHkpXG5cdFx0d3JhcHBlci5zdHlsZS5vcGFjaXR5ID0gb3BhY2l0eSArIDAuMSA8PSAxID8gYCR7b3BhY2l0eSArIDAuMX1gIDogYDFgXG5cdH1cblx0b3BhY2l0eV9tb3JlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGFjaXR5X21vcmVfaGFuZGxlcilcblxuXG5cdGxldCBiZ19zdGF0ZSA9IDAuNVxuXG5cdGNvbnN0IGJnX3N0YXRlX3RvZ2dsZXIgPSAoKSA9PiB7XG5cdFx0aWYgKGJnX3N0YXRlID09IDAuNSkge1xuXHRcdFx0d3JhcHBlci5zdHlsZS5iYWNrZ3JvdW5kID0gXCJyZ2JhKDAsMCwwLDEpXCJcblx0XHRcdGJnX3N0YXRlID0gMVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR3cmFwcGVyLnN0eWxlLmJhY2tncm91bmQgPSBcInJnYmEoMCwwLDAsMC41KVwiXG5cdFx0XHRiZ19zdGF0ZSA9IDAuNVxuXHRcdH1cblx0fVxuXG5cdHRyYW5zcGFyZW50X2JhY2tncm91bmQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGJnX3N0YXRlX3RvZ2dsZXIpXG5cblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG5cdFx0aWYgKGUuY3RybEtleSAmJiBlLmFsdEtleSkge1xuXHRcdFx0aWYgKGUua2V5ID09IFwiLVwiKSB7XG5cdFx0XHRcdG9wYWNpdHlfbGVzc19oYW5kbGVyKClcblx0XHRcdH0gZWxzZSBpZiAoZS5rZXkgPT0gXCIrXCIgfHwgZS5rZXkgPT0gXCI9XCIpIHtcblx0XHRcdFx0b3BhY2l0eV9tb3JlX2hhbmRsZXIoKVxuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoZS5jdHJsS2V5ICYmICFlLmFsdEtleSAmJiAhZS5zaGlmdEtleSAmJiBlLmtleSA9PSBcIlRhYlwiKSB7XG5cdFx0XHRiZ19zdGF0ZV90b2dnbGVyKClcblx0XHR9XG5cdH0pXG59KVxuXG5mdW5jdGlvbiBtc190b190aW1lKG1zOiBudW1iZXIpIHtcblx0bGV0IHNlY29uZHMgPSBNYXRoLmZsb29yKChtcyAvIDEwMDApICUgNjApLnRvU3RyaW5nKClcblx0bGV0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChtcyAvICgxMDAwICogNjApKSAlIDYwKS50b1N0cmluZygpXG5cdGxldCBob3VycyA9IE1hdGguZmxvb3IoKG1zIC8gKDEwMDAgKiA2MCAqIDYwKSkgJSAyNCkudG9TdHJpbmcoKVxuXG5cdHJldHVybiBgJHtob3Vycy5wYWRTdGFydCgyLCBcIjBcIil9OiR7bWludXRlcy5wYWRTdGFydCgyLCBcIjBcIil9OiR7c2Vjb25kcy5wYWRTdGFydCgyLCBcIjBcIil9YFxufVxuXG5cbmZ1bmN0aW9uIGZsZXhfZGV0ZWN0b3IoZWxlbWVudDogSFRNTEVsZW1lbnQsIHJvd19vcl9jb2x1bW46IFwicm93XCIgfCBcImNvbHVtblwiID0gXCJyb3dcIikge1xuXHRsZXQgZGlyOiB7IHBvczogXCJ4XCIgfCBcInlcIiwgd19vcl9oOiBcIndpZHRoXCIgfCBcImhlaWdodFwiIH0gPSB7IHBvczogXCJ5XCIsIHdfb3JfaDogXCJoZWlnaHRcIiB9XG5cdGlmIChyb3dfb3JfY29sdW1uID09IFwiY29sdW1uXCIpIHtcblx0XHRkaXIgPSB7IHBvczogXCJ4XCIsIHdfb3JfaDogXCJ3aWR0aFwiIH1cblx0fVxuXG5cdGxldCBlbCA9IGVsZW1lbnRcblxuXHRsZXQgZmlyc3QgPSBlbC5jaGlsZHJlblswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSBhcyB7IFtrZXk6IHN0cmluZ106IGFueSB9XG5cdGxldCBsYXN0ID0gZWwuY2hpbGRyZW5bZWwuY2hpbGRyZW4ubGVuZ3RoIC0gMV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgYXMge1trZXk6c3RyaW5nXTogYW55fVxuXHQvLyBzaG91bGQgd29yayBldmVuIGlmIHRoZSBmbGV4IGl0ZW1zIGFyZSBkaWZmZXJlbnQgaGVpZ2h0c1xuXHQvLyBvbmx5IGV4Y2VwdGlvbnMgaSB0aGluayBhcmUgaWYgdGhlIGVsZW1lbnQgYWxpZ25zIGl0c2VsZiBiZWxvdyBhbm90aGVyIGVsZW1lbnQgc29tZWhvd1xuXG5cdGlmIChmaXJzdFtkaXIucG9zXSArIGZpcnN0W2Rpci53X29yX2hdIDwgbGFzdFtkaXIucG9zXSkge1xuXHRcdHJldHVybiB0cnVlXG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlXG5cdH1cbn1cbiJdfQ==